<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-简历内容" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/11/01/%E7%AE%80%E5%8E%86%E5%86%85%E5%AE%B9/" class="article-date">
  <time class="dt-published" datetime="2024-11-01T02:18:48.000Z" itemprop="datePublished">2024-11-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a>►<a class="article-category-link" href="/categories/%E9%A1%B9%E7%9B%AE/%E6%8F%8F%E8%BF%B0%E4%B8%8E%E9%9D%A2%E8%AF%95/">描述与面试</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/11/01/%E7%AE%80%E5%8E%86%E5%86%85%E5%AE%B9/">简历内容</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="mt"><a href="#mt" class="headerlink" title="mt"></a>mt</h2><ol>
<li>激励流水表写入优化：流水记录表状态不准确，影响到数据结果统计。一方面通过修改流水处理逻辑，细化资源发放状态和数据状态，添加分布式锁保证数据一致性，并根据场景做sql优化。对于回调信息，改为延迟消费5s并配置死信队列，保证系统的健壮性。</li>
<li>激励流水单独迁移服务：通过kafka更新数据，流水服务通过rpc对外提供数据查询，实现系统解耦并提高了可拓展性。</li>
<li>参与错误码治理及告警配置工作。采用AOP编程思想，通过优化错误码方案，设置告警维度，为告警配置添加动态阈值，同比环比对比，波动策略等方式，减少误报率50%以上。</li>
<li>与跨部门团队协作，完成多个项目的需求分析和技术文档编写。</li>
</ol>
<h2 id="baosight"><a href="#baosight" class="headerlink" title="baosight"></a>baosight</h2><ol>
<li>优化OPCUA服务器性能：通过..zip_tree，在多client订阅server上高频更新的多node的场景下，server cpu usage降低30%以上</li>
<li>负责实现OPCUA服务器的加密通信：通过</li>
<li>多订阅场景：<img src="/2024/11/01/%E7%AE%80%E5%8E%86%E5%86%85%E5%AE%B9/image-1.png" alt="alt text"><img src="/2024/11/01/%E7%AE%80%E5%8E%86%E5%86%85%E5%AE%B9/image.png" alt="alt text"></li>
<li>用epoll代替select提高服务器IO的性能</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/11/01/%E7%AE%80%E5%8E%86%E5%86%85%E5%AE%B9/" data-id="cm31tgkom0002qovc72090fxh" data-title="简历内容" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-OPCUA-open62541事件" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/11/01/OPCUA-open62541%E4%BA%8B%E4%BB%B6/" class="article-date">
  <time class="dt-published" datetime="2024-11-01T01:59:46.000Z" itemprop="datePublished">2024-11-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/">实习</a>►<a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/baosight/">baosight</a>►<a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/baosight/OPC-UA/">OPC_UA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/11/01/OPCUA-open62541%E4%BA%8B%E4%BB%B6/">OPCUA-open62541事件</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><ul>
<li><p>为什么要使用事件？</p>
<ul>
<li>对于变量检测，有两个缺点：一、有一定的延迟（采样时间） 二、无法提供事件的相关信息，如发生时间点，严重程度，哪个发生的等等。而且，假如监测多个互相有关联的变量，当只有一个发生变化时，回调函数里只会输出这一个变量的值，但是这个时候我们想看到所有其它变量的值（虽然没有发生变化），来综合分析这些数据</li>
</ul>
</li>
<li><p>condition：通用术语，是事件的延伸</p>
<ul>
<li>代表系统或其某个组件的状态。但是，在某些情况下，还必须保持仍需关注的先前状态。引入 ConditionBranchches 就是为了满足这一要求，并区分当前状态和先前状态。每个 ConditionBranch 都有一个 BranchId，用于将其与同一 Condition 实例的其他分支区分开来。代表条件当前状态的条件分支（主干）的 BranchId 为空。服务器可为每个分支生成单独的事件通知。当某个 ConditionBranch 所代表的状态不需要进一步关注时，该分支的最终事件通知将把 Retain 属性设为 “假”。第 5.5 条提供了更多信息和用例。对于服务器来说，保留以前的状态和支持多个分支是可选的。</li>
<li>如何处理以前的状态？有些系统要求将 “条件 ”的先前状态保留一段时间。一个常见的用例就是确认过程。在某些环境中，要求同时确认进入激活状态和非激活状态的转换。具有严格安全规则的系统有时要求必须确认每次进入激活状态的转换。在短时间内连续发生状态变化的情况下，可能会出现多个未确认状态，服务器会为所有之前的未确认状态保留条件分支（ConditionBranches）。这些分支将在确认后或达到最终状态时被删除。</li>
<li>关于条件刷新（ConditionRefresh），应注意以下几点：<ol>
<li>有些系统要求将条件的先前状态保留一段时间。有些服务器（尤其是需要确认先前状态的服务器）会为仍需关注的先前状态保留单独的 ConditionBranches。</li>
<li>ConditionRefresh 应针对条件实例的所有相关状态（当前和以前）发布事件通知，因此客户机可以针对具有不同分支标识的条件实例接收多个事件。</li>
<li>在某些情况下，服务器可能无法确保客户端与条件实例的当前状态完全同步。例如，如果服务器所代表的底层系统被重置或通信中断一段时间，服务器可能需要与底层系统重新同步。在这种情况下，服务器应发送 RefreshRequiredEventType 类型的事件，告知客户端可能需要刷新。接收到该特殊事件的客户机应按照本条款的规定启动条件刷新（ConditionRefresh）。</li>
<li>为确保客户机始终得到通知，三种特殊事件类型（RefreshEndEventType、RefreshStartEventType 和 RefreshRequiredEventType）会忽略与订阅相关的事件内容过滤，并始终发送给客户。</li>
<li>ConditionRefresh 适用于订阅。如果同一订阅中包含多个事件通知程序，则会刷新所有事件通知程序。</li>
</ol>
</li>
<li>condition的三个重要变量：severity，quality，comment – 紧急程度，用户生成的描述字符串，条件所依据的数据值的质量。它们任何一个变化都会导致事件通知</li>
</ul>
</li>
<li><p>alarm：与通常需要确认的状态条件相关联的事件类型</p>
<ul>
<li>active：alarm所代表的情况仍然存在</li>
<li>alarmflood：alarm的频率超过了处理能力范围</li>
<li>alarmsuppressiongroup：用于抑制其他警报的警报组。 </li>
<li>警报是 AcknowledgeableConditions（可确认条件）的特化，在条件中添加了活动状态和其他状态（如搁置状态和抑制状态）的概念。</li>
<li>处于激活状态的警报表示当前存在该条件所代表的情况。当警报处于非活动状态时，它所代表的情况已恢复到正常状态。<ul>
<li>某些警报子类型引入了活动状态的子状态。例如，代表温度的警报可提供高电平状态和临界高电平状态。<ol>
<li>搁置状态可由操作员通过 OPC UA 方法设置。由于系统的特殊原因，抑制状态由服务器内部设置。警报系统通常实施抑制、停止服务和搁置功能，通过限制操作员在当前警报显示屏上看到的警报数量，防止操作员在警报 “风暴 ”期间不知所措。具体做法是在二阶依赖性警报和&#x2F;或严重性较低的警报上设置抑制或搁置标志，从而使操作员集中精力处理最关键的问题。</li>
<li>锁定状态（LatchedState）是一种添加到任何需要额外处理的报警中的状态，一旦激活，即使触发报警的值恢复正常，在明确重置之前也不会清除。这可能是警报发生后需要进行物理检查以确保其不再处于警报状态，也可能是需要进行一系列测试以确保警报不再处于活动状态或其他一些操作。通过添加此可选子状态，任何 AlarmType 都可以成为锁定报警。</li>
<li>搁置、停止服务和抑制状态与禁用状态的不同之处在于，警报仍可完全正常工作，并可包含在向客户发送的订阅通知中。禁用的警报不会以任何方式处理，也不支持作为 ISA 18.2 中定义的活动警报模型的一部分。</li>
</ol>
</li>
<li>警报遵循典型的时间轴。它们有一些相关的延迟时间和可能占据的一些状态。警报系统的目标是及时向操作员通报情况，并允许操作员在某些后果发生之前采取某些措施。这些后果可能是经济后果（产品无法使用，必须丢弃），可能是物理后果（储罐溢出），可能是安全后果（可能发生火灾或爆炸），也可能是其他各种可能性中的任何一种。通常情况下，如果在一段时间内没有采取任何与警报相关的措施，流程就会越过某个阈值，此时就会开始产生后果。OPC UA 警报模型描述了这些状态、延迟和行动。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><h3 id="通过事件节点触发"><a href="#通过事件节点触发" class="headerlink" title="通过事件节点触发"></a>通过事件节点触发</h3><ul>
<li><p>首先，需要定义事件类型，所有自定义的事件类型都必须以BaseEventType作为抽象基类，我们创建的新事件类型就是它的子类型</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> UA_NodeId eventType;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> UA_StatusCode <span class="title function_">addNewEventType</span><span class="params">(UA_Server *server)</span> </span><br><span class="line">&#123;</span><br><span class="line">    UA_ObjectTypeAttributes attr = UA_ObjectTypeAttributes_default;</span><br><span class="line">    attr.displayName = UA_LOCALIZEDTEXT(<span class="string">&quot;en-US&quot;</span>, <span class="string">&quot;SimpleEventType&quot;</span>);</span><br><span class="line">    attr.description = UA_LOCALIZEDTEXT(<span class="string">&quot;en-US&quot;</span>, <span class="string">&quot;The simple event type we created&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> UA_Server_addObjectTypeNode(server, UA_NODEID_NULL,</span><br><span class="line">                                      UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_BASEEVENTTYPE),</span><br><span class="line">                                      UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_HASSUBTYPE),</span><br><span class="line">                                      UA_QUALIFIEDNAME(<span class="number">0</span>, <span class="string">&quot;SimpleEventType&quot;</span>),</span><br><span class="line">                                      attr, <span class="literal">NULL</span>, &amp;eventType);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>事件可以设置多种属性</p>
<ul>
<li><img src="/2024/11/01/OPCUA-open62541%E4%BA%8B%E4%BB%B6/%E4%BA%8B%E4%BB%B6%E7%B1%BB%E5%9E%8B.png" alt="alt text"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> UA_StatusCode <span class="title function_">setUpEvent</span><span class="params">(UA_Server *server, UA_NodeId *outId)</span> &#123;</span><br><span class="line">  UA_StatusCode retval = UA_Server_createEvent(server, eventType, outId);</span><br><span class="line">  <span class="keyword">if</span> (retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">      UA_LOG_WARNING(UA_Log_Stdout, UA_LOGCATEGORY_SERVER,</span><br><span class="line">                    <span class="string">&quot;createEvent failed. StatusCode %s&quot;</span>, UA_StatusCode_name(retval));</span><br><span class="line">      <span class="keyword">return</span> retval;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Set the Event Attributes */</span></span><br><span class="line">  <span class="comment">/* Setting the Time is required or else the event will not show up in UAExpert! */</span></span><br><span class="line">  UA_DateTime eventTime = UA_DateTime_now();</span><br><span class="line">  UA_Server_writeObjectProperty_scalar(server, *outId, UA_QUALIFIEDNAME(<span class="number">0</span>, <span class="string">&quot;Time&quot;</span>),</span><br><span class="line">                                      &amp;eventTime, &amp;UA_TYPES[UA_TYPES_DATETIME]);</span><br><span class="line"></span><br><span class="line">  UA_UInt16 eventSeverity = <span class="number">100</span>;</span><br><span class="line">  UA_Server_writeObjectProperty_scalar(server, *outId, UA_QUALIFIEDNAME(<span class="number">0</span>, <span class="string">&quot;Severity&quot;</span>),</span><br><span class="line">                                      &amp;eventSeverity, &amp;UA_TYPES[UA_TYPES_UINT16]);</span><br><span class="line"></span><br><span class="line">  UA_LocalizedText eventMessage = UA_LOCALIZEDTEXT(<span class="string">&quot;en-US&quot;</span>, <span class="string">&quot;An event has been generated.&quot;</span>);</span><br><span class="line">  UA_Server_writeObjectProperty_scalar(server, *outId, UA_QUALIFIEDNAME(<span class="number">0</span>, <span class="string">&quot;Message&quot;</span>),</span><br><span class="line">                                      &amp;eventMessage, &amp;UA_TYPES[UA_TYPES_LOCALIZEDTEXT]);</span><br><span class="line"></span><br><span class="line">  UA_String eventSourceName = UA_STRING(<span class="string">&quot;Server&quot;</span>);</span><br><span class="line">  UA_Server_writeObjectProperty_scalar(server, *outId, UA_QUALIFIEDNAME(<span class="number">0</span>, <span class="string">&quot;SourceName&quot;</span>),</span><br><span class="line">                                      &amp;eventSourceName, &amp;UA_TYPES[UA_TYPES_STRING]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> UA_STATUSCODE_GOOD;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>先使用UA_Server_createEvent()根据定义的事件类型来创建事件（事件也是一个node），然后使用UA_Server_writeObjectProperty_scalar设置了这个事件的Time，Severity，Message和SourceName这些属性。</li>
</ul>
</li>
<li><p>在方法的回调函数里触发事件</p>
<ul>
<li>定义回调函数<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> UA_StatusCode <span class="title function_">generateEventMethodCallback</span><span class="params">(UA_Server *server,</span></span><br><span class="line"><span class="params">                        <span class="type">const</span> UA_NodeId *sessionId, <span class="type">void</span> *sessionHandle,</span></span><br><span class="line"><span class="params">                        <span class="type">const</span> UA_NodeId *methodId, <span class="type">void</span> *methodContext,</span></span><br><span class="line"><span class="params">                        <span class="type">const</span> UA_NodeId *objectId, <span class="type">void</span> *objectContext,</span></span><br><span class="line"><span class="params">                        <span class="type">size_t</span> inputSize, <span class="type">const</span> UA_Variant *input,</span></span><br><span class="line"><span class="params">                        <span class="type">size_t</span> outputSize, UA_Variant *output)</span> </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    UA_LOG_INFO(UA_Log_Stdout, UA_LOGCATEGORY_USERLAND, <span class="string">&quot;Creating event&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* set up event */</span></span><br><span class="line">    UA_NodeId eventNodeId;</span><br><span class="line">    UA_StatusCode retval = setUpEvent(server, &amp;eventNodeId);</span><br><span class="line">    <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">        UA_LOG_WARNING(UA_Log_Stdout, UA_LOGCATEGORY_USERLAND,</span><br><span class="line">                      <span class="string">&quot;Creating event failed. StatusCode %s&quot;</span>, UA_StatusCode_name(retval));</span><br><span class="line">        <span class="keyword">return</span> retval;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    retval = UA_Server_triggerEvent(server, eventNodeId,</span><br><span class="line">                                    UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_SERVER),</span><br><span class="line">                                    <span class="literal">NULL</span>, UA_TRUE);</span><br><span class="line">    <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD)</span><br><span class="line">        UA_LOG_WARNING(UA_Log_Stdout, UA_LOGCATEGORY_USERLAND,</span><br><span class="line">                      <span class="string">&quot;Triggering event failed. StatusCode %s&quot;</span>, UA_StatusCode_name(retval));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retval;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>创建方法节点<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span> <span class="title function_">addGenerateEventMethod</span><span class="params">(UA_Server *server)</span> </span><br><span class="line">&#123;</span><br><span class="line">    UA_MethodAttributes generateAttr = UA_MethodAttributes_default;</span><br><span class="line">    generateAttr.description = UA_LOCALIZEDTEXT(<span class="string">&quot;en-US&quot;</span>,<span class="string">&quot;Generate an event.&quot;</span>);</span><br><span class="line">    generateAttr.displayName = UA_LOCALIZEDTEXT(<span class="string">&quot;en-US&quot;</span>,<span class="string">&quot;Generate Event&quot;</span>);</span><br><span class="line">    generateAttr.executable = <span class="literal">true</span>;</span><br><span class="line">    generateAttr.userExecutable = <span class="literal">true</span>;</span><br><span class="line">    UA_Server_addMethodNode(server, UA_NODEID_NUMERIC(<span class="number">1</span>, <span class="number">62541</span>),</span><br><span class="line">                            UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_OBJECTSFOLDER),</span><br><span class="line">                            UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_HASORDEREDCOMPONENT),</span><br><span class="line">                            UA_QUALIFIEDNAME(<span class="number">1</span>, <span class="string">&quot;Generate Event&quot;</span>),</span><br><span class="line">                            generateAttr, &amp;generateEventMethodCallback,</span><br><span class="line">                            <span class="number">0</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="通过订阅"><a href="#通过订阅" class="headerlink" title="通过订阅"></a>通过订阅</h3><h2 id="源码解析"><a href="#源码解析" class="headerlink" title="源码解析"></a>源码解析</h2><h3 id="createEvent-根据定义的事件类型来创建事件"><a href="#createEvent-根据定义的事件类型来创建事件" class="headerlink" title="createEvent() 根据定义的事件类型来创建事件"></a>createEvent() 根据定义的事件类型来创建事件</h3>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">UA_StatusCode</span><br><span class="line"><span class="title function_">createEvent</span><span class="params">(UA_Server *server, <span class="type">const</span> UA_NodeId eventType, UA_NodeId *outNodeId)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(!outNodeId) &#123;</span><br><span class="line">        UA_LOG_ERROR(server-&gt;config.logging, UA_LOGCATEGORY_USERLAND,</span><br><span class="line">                    <span class="string">&quot;outNodeId must not be NULL. The event&#x27;s NodeId must be returned &quot;</span></span><br><span class="line">                    <span class="string">&quot;so it can be triggered.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> UA_STATUSCODE_BADINVALIDARGUMENT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Make sure the eventType is a subtype of BaseEventType */</span></span><br><span class="line">    UA_NodeId baseEventTypeId = UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_BASEEVENTTYPE);</span><br><span class="line">    <span class="keyword">if</span>(!isNodeInTree_singleRef(server, &amp;eventType, &amp;baseEventTypeId,</span><br><span class="line">                              UA_REFERENCETYPEINDEX_HASSUBTYPE)) &#123;</span><br><span class="line">        UA_LOG_ERROR(server-&gt;config.logging, UA_LOGCATEGORY_USERLAND,</span><br><span class="line">                    <span class="string">&quot;Event type must be a subtype of BaseEventType!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> UA_STATUSCODE_BADINVALIDARGUMENT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Create an ObjectNode which represents the event */</span></span><br><span class="line">    UA_QualifiedName name;</span><br><span class="line">    <span class="comment">/*  set a dummy name. This is not used. */</span></span><br><span class="line">    name = UA_QUALIFIEDNAME(<span class="number">0</span>,<span class="string">&quot;E&quot;</span>);</span><br><span class="line">    UA_NodeId newNodeId = UA_NODEID_NULL;</span><br><span class="line">    UA_ObjectAttributes oAttr = UA_ObjectAttributes_default;</span><br><span class="line">    <span class="comment">// 注意这里是创建了一个object类型的节点</span></span><br><span class="line">    UA_StatusCode retval = addNode(server, UA_NODECLASS_OBJECT,</span><br><span class="line">                                  UA_NODEID_NULL, <span class="comment">/* Set a random unused NodeId */</span></span><br><span class="line">                                  UA_NODEID_NULL, <span class="comment">/* No parent */</span></span><br><span class="line">                                  UA_NODEID_NULL, <span class="comment">/* No parent reference */</span></span><br><span class="line">                                  name,           <span class="comment">/* an event does not have a name */</span></span><br><span class="line">                                  eventType,      <span class="comment">/* the type of the event */</span></span><br><span class="line">                                  &amp;oAttr,         <span class="comment">/* default attributes are fine */</span></span><br><span class="line">                                  &amp;UA_TYPES[UA_TYPES_OBJECTATTRIBUTES],</span><br><span class="line">                                  <span class="literal">NULL</span>,           <span class="comment">/* no node context */</span></span><br><span class="line">                                  &amp;newNodeId);</span><br><span class="line">    <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">        UA_LOG_ERROR(server-&gt;config.logging, UA_LOGCATEGORY_USERLAND,</span><br><span class="line">                    <span class="string">&quot;Adding event failed. StatusCode %s&quot;</span>, UA_StatusCode_name(retval));</span><br><span class="line">        <span class="keyword">return</span> retval;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Find the eventType variable */</span></span><br><span class="line">    <span class="comment">// 这样操作的原因是eventType是刚刚创建的节点的一个子节点，我们是要写入子节点值，</span></span><br><span class="line">    name = UA_QUALIFIEDNAME(<span class="number">0</span>, <span class="string">&quot;EventType&quot;</span>);</span><br><span class="line">    UA_BrowsePathResult bpr = browseSimplifiedBrowsePath(server, newNodeId, <span class="number">1</span>, &amp;name);</span><br><span class="line">    <span class="keyword">if</span>(bpr.statusCode != UA_STATUSCODE_GOOD || bpr.targetsSize &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        retval = bpr.statusCode;</span><br><span class="line">        UA_BrowsePathResult_clear(&amp;bpr);</span><br><span class="line">        deleteNode(server, newNodeId, <span class="literal">true</span>);</span><br><span class="line">        UA_NodeId_clear(&amp;newNodeId);</span><br><span class="line">        <span class="keyword">return</span> retval;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Set the EventType */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    在 OPC UA 中，EventType 是一个属性节点（VariableNode），用来明确标识该事件的具体类型。</span></span><br><span class="line"><span class="comment">    当调用 addNode 时，服务器会基于 eventType 参数生成一个 EventType 属性节点，但该属性节点的值默认是 未设置 或是继承自基类的默认值。</span></span><br><span class="line"><span class="comment">    显式设置 EventType 的值是为了：</span></span><br><span class="line"><span class="comment">    确保 EventType 属性明确指定了事件的具体类型（尤其是子类型）。</span></span><br><span class="line"><span class="comment">    避免默认值导致客户端解析错误。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    一个更具体的例子</span></span><br><span class="line"><span class="comment">    假设事件类型是 TemperatureAlarmType，它是 AlarmConditionType 的子类型。</span></span><br><span class="line"><span class="comment">    在 addNode 时：</span></span><br><span class="line"><span class="comment">    传入的 eventType 是 TemperatureAlarmType。</span></span><br><span class="line"><span class="comment">    服务器会：</span></span><br><span class="line"><span class="comment">    创建一个事件对象节点。</span></span><br><span class="line"><span class="comment">    根据 TemperatureAlarmType 的定义，附加所有必要的子节点和属性（如 EventType、SourceNode 等）。</span></span><br><span class="line"><span class="comment">    但 EventType 属性的值：</span></span><br><span class="line"><span class="comment">    默认情况下，可能是 AlarmConditionType，因为这是继承的类型。</span></span><br><span class="line"><span class="comment">    如果客户端需要获取这个事件的实际类型，而 EventType 没有被正确设置为 TemperatureAlarmType，会造成语义上的问题。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    UA_Variant value;</span><br><span class="line">    UA_Variant_init(&amp;value);</span><br><span class="line">    UA_Variant_setScalar(&amp;value, (<span class="type">void</span>*)(<span class="type">uintptr_t</span>)&amp;eventType, &amp;UA_TYPES[UA_TYPES_NODEID]);</span><br><span class="line">    retval = writeValueAttribute(server, bpr.targets[<span class="number">0</span>].targetId.nodeId, &amp;value);</span><br><span class="line">    UA_BrowsePathResult_clear(&amp;bpr);</span><br><span class="line">    <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">        deleteNode(server, newNodeId, <span class="literal">true</span>);</span><br><span class="line">        UA_NodeId_clear(&amp;newNodeId);</span><br><span class="line">        <span class="keyword">return</span> retval;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    *outNodeId = newNodeId;</span><br><span class="line">    <span class="keyword">return</span> UA_STATUSCODE_GOOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">UA_StatusCode</span><br><span class="line"><span class="title function_">UA_Server_createEvent</span><span class="params">(UA_Server *server, <span class="type">const</span> UA_NodeId eventType,</span></span><br><span class="line"><span class="params">                      UA_NodeId *outNodeId)</span> &#123;</span><br><span class="line">    UA_LOCK(&amp;server-&gt;serviceMutex);</span><br><span class="line">    UA_StatusCode res = createEvent(server, eventType, outNodeId);</span><br><span class="line">    UA_UNLOCK(&amp;server-&gt;serviceMutex);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="triggerEvent-定义事件触发"><a href="#triggerEvent-定义事件触发" class="headerlink" title="triggerEvent() 定义事件触发"></a>triggerEvent() 定义事件触发</h3><p>&#x2F;&#x2F; origin 2253<br>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">UA_StatusCode</span><br><span class="line"><span class="title function_">triggerEvent</span><span class="params">(UA_Server *server, <span class="type">const</span> UA_NodeId eventNodeId,</span></span><br><span class="line"><span class="params">            <span class="type">const</span> UA_NodeId origin, UA_ByteString *outEventId,</span></span><br><span class="line"><span class="params">            <span class="type">const</span> UA_Boolean deleteEventNode)</span> &#123;</span><br><span class="line">    UA_LOCK_ASSERT(&amp;server-&gt;serviceMutex, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    UA_LOG_NODEID_DEBUG(&amp;origin,</span><br><span class="line">        UA_LOG_DEBUG(server-&gt;config.logging, UA_LOGCATEGORY_SERVER,</span><br><span class="line">            <span class="string">&quot;Events: An event is triggered on node %.*s&quot;</span>,</span><br><span class="line">            (<span class="type">int</span>)nodeIdStr.length, nodeIdStr.data));</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> UA_ENABLE_SUBSCRIPTIONS_ALARMS_CONDITIONS</span></span><br><span class="line">    UA_Boolean isCallerAC = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(isConditionOrBranch(server, &amp;eventNodeId, &amp;origin, &amp;isCallerAC)) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!isCallerAC) &#123;</span><br><span class="line">          UA_LOG_WARNING(server-&gt;config.logging, UA_LOGCATEGORY_SERVER,</span><br><span class="line">                                <span class="string">&quot;Condition Events: Please use A&amp;C API to trigger Condition Events 0x%08X&quot;</span>,</span><br><span class="line">                                  UA_STATUSCODE_BADINVALIDARGUMENT);</span><br><span class="line">          <span class="keyword">return</span> UA_STATUSCODE_BADINVALIDARGUMENT;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">/* UA_ENABLE_SUBSCRIPTIONS_ALARMS_CONDITIONS */</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Check that the origin node exists */</span></span><br><span class="line">    <span class="type">const</span> UA_Node *originNode = UA_NODESTORE_GET(server, &amp;origin);</span><br><span class="line">    <span class="keyword">if</span>(!originNode) &#123;</span><br><span class="line">        UA_LOG_ERROR(server-&gt;config.logging, UA_LOGCATEGORY_USERLAND,</span><br><span class="line">                    <span class="string">&quot;Origin node for event does not exist.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> UA_STATUSCODE_BADNOTFOUND;</span><br><span class="line">    &#125;</span><br><span class="line">    UA_NODESTORE_RELEASE(server, originNode);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Make sure the origin is in the ObjectsFolder (<span class="doctag">TODO:</span> or in the ViewsFolder) */</span></span><br><span class="line">    <span class="comment">/* Only use Organizes and HasComponent to check if we are below the ObjectsFolder */</span></span><br><span class="line">    UA_StatusCode retval;</span><br><span class="line">    UA_ReferenceTypeSet refTypes;</span><br><span class="line">    UA_ReferenceTypeSet_init(&amp;refTypes);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) &#123;</span><br><span class="line">        UA_ReferenceTypeSet tmpRefTypes;</span><br><span class="line">        retval = referenceTypeIndices(server, &amp;isInFolderReferences[i], &amp;tmpRefTypes, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">            UA_LOG_WARNING(server-&gt;config.logging, UA_LOGCATEGORY_SERVER,</span><br><span class="line">                          <span class="string">&quot;Events: Could not create the list of references and their subtypes &quot;</span></span><br><span class="line">                          <span class="string">&quot;with StatusCode %s&quot;</span>, UA_StatusCode_name(retval));</span><br><span class="line">        &#125;</span><br><span class="line">        refTypes = UA_ReferenceTypeSet_union(refTypes, tmpRefTypes);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!isNodeInTree(server, &amp;origin, &amp;objectsFolderId, &amp;refTypes)) &#123;</span><br><span class="line">        UA_LOG_ERROR(server-&gt;config.logging, UA_LOGCATEGORY_USERLAND,</span><br><span class="line">                    <span class="string">&quot;Node for event must be in ObjectsFolder!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> UA_STATUSCODE_BADINVALIDARGUMENT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Update the standard fields of the event */</span></span><br><span class="line">    <span class="comment">// 为事件节点设置标准字段（如 EventId、ReceiveTime)</span></span><br><span class="line">    retval = eventSetStandardFields(server, &amp;eventNodeId, &amp;origin, outEventId);</span><br><span class="line">    <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">        UA_LOG_WARNING(server-&gt;config.logging, UA_LOGCATEGORY_SERVER,</span><br><span class="line">                      <span class="string">&quot;Events: Could not set the standard event fields with StatusCode %s&quot;</span>,</span><br><span class="line">                      UA_StatusCode_name(retval));</span><br><span class="line">        <span class="keyword">return</span> retval;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* List of nodes that emit the node. Events propagate upwards (bubble up) in</span></span><br><span class="line"><span class="comment">    * the node hierarchy. */</span></span><br><span class="line">    UA_ExpandedNodeId *emitNodes = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">size_t</span> emitNodesSize = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Add the server node to the list of nodes from which the event is emitted.</span></span><br><span class="line"><span class="comment">    * The server node emits all events.</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * Part 3, 7.17: In particular, the root notifier of a Server, the Server</span></span><br><span class="line"><span class="comment">    * Object defined in Part 5, is always capable of supplying all Events from</span></span><br><span class="line"><span class="comment">    * a Server and as such has implied HasEventSource References to every event</span></span><br><span class="line"><span class="comment">    * source in a Server. */</span></span><br><span class="line">    UA_NodeId emitStartNodes[<span class="number">2</span>];</span><br><span class="line">    emitStartNodes[<span class="number">0</span>] = origin;</span><br><span class="line">    emitStartNodes[<span class="number">1</span>] = UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_SERVER);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Get all ReferenceTypes over which the events propagate */</span></span><br><span class="line">    <span class="comment">// 找到事件要的传播路径</span></span><br><span class="line">    UA_ReferenceTypeSet emitRefTypes;</span><br><span class="line">    UA_ReferenceTypeSet_init(&amp;emitRefTypes);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; EMIT_REFS_ROOT_COUNT; i++) &#123;</span><br><span class="line">        UA_ReferenceTypeSet tmpRefTypes;</span><br><span class="line">        retval = referenceTypeIndices(server, &amp;emitReferencesRoots[i], &amp;tmpRefTypes, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">            UA_LOG_WARNING(server-&gt;config.logging, UA_LOGCATEGORY_SERVER,</span><br><span class="line">                          <span class="string">&quot;Events: Could not create the list of references for event &quot;</span></span><br><span class="line">                          <span class="string">&quot;propagation with StatusCode %s&quot;</span>, UA_StatusCode_name(retval));</span><br><span class="line">            <span class="keyword">goto</span> cleanup;</span><br><span class="line">        &#125;</span><br><span class="line">        emitRefTypes = UA_ReferenceTypeSet_union(emitRefTypes, tmpRefTypes);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Get the list of nodes in the hierarchy that emits the event. */</span></span><br><span class="line">    <span class="comment">// 从 origin 开始，沿着定义的传播路径（引用类型）递归浏览，找到所有可能监听事件的节点。</span></span><br><span class="line">    retval = browseRecursive(server, <span class="number">2</span>, emitStartNodes, UA_BROWSEDIRECTION_INVERSE,</span><br><span class="line">                            &amp;emitRefTypes, UA_NODECLASS_UNSPECIFIED, <span class="literal">true</span>,</span><br><span class="line">                            &amp;emitNodesSize, &amp;emitNodes);</span><br><span class="line">    <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">        UA_LOG_WARNING(server-&gt;config.logging, UA_LOGCATEGORY_SERVER,</span><br><span class="line">                      <span class="string">&quot;Events: Could not create the list of nodes listening on the &quot;</span></span><br><span class="line">                      <span class="string">&quot;event with StatusCode %s&quot;</span>, UA_StatusCode_name(retval));</span><br><span class="line">        <span class="keyword">goto</span> cleanup;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Add the event to the listening MonitoredItems at each relevant node */</span></span><br><span class="line">    <span class="comment">// 通知订阅</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; emitNodesSize; i++) &#123;</span><br><span class="line">        <span class="comment">/* Get the node */</span></span><br><span class="line">        <span class="type">const</span> UA_Node *node = UA_NODESTORE_GET(server, &amp;emitNodes[i].nodeId);</span><br><span class="line">        <span class="keyword">if</span>(!node)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Only consider objects */</span></span><br><span class="line">        <span class="keyword">if</span>(node-&gt;head.nodeClass != UA_NODECLASS_OBJECT) &#123;</span><br><span class="line">            UA_NODESTORE_RELEASE(server, node);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Add event to monitoreditems */</span></span><br><span class="line">        UA_MonitoredItem *mon = node-&gt;head.monitoredItems;</span><br><span class="line">        <span class="keyword">for</span>(; mon != <span class="literal">NULL</span>; mon = mon-&gt;sampling.nodeListNext) &#123;</span><br><span class="line">            <span class="comment">/* Is this an Event-MonitoredItem? */</span></span><br><span class="line">            <span class="keyword">if</span>(mon-&gt;itemToMonitor.attributeId != UA_ATTRIBUTEID_EVENTNOTIFIER)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            retval = UA_MonitoredItem_addEvent(server, mon, &amp;eventNodeId);</span><br><span class="line">            <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">                UA_LOG_WARNING(server-&gt;config.logging, UA_LOGCATEGORY_SERVER,</span><br><span class="line">                              <span class="string">&quot;Events: Could not add the event to a listening &quot;</span></span><br><span class="line">                              <span class="string">&quot;node with StatusCode %s&quot;</span>, UA_StatusCode_name(retval));</span><br><span class="line">                retval = UA_STATUSCODE_GOOD; <span class="comment">/* Only log problems with individual emit nodes */</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        UA_NODESTORE_RELEASE(server, node);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Add event entry in the historical database */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> UA_ENABLE_HISTORIZING</span></span><br><span class="line">        <span class="keyword">if</span>(server-&gt;config.historyDatabase.setEvent)</span><br><span class="line">            setHistoricalEvent(server, &amp;origin, &amp;emitNodes[i].nodeId, &amp;eventNodeId);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Delete the node representation of the event */</span></span><br><span class="line">    <span class="keyword">if</span>(deleteEventNode) &#123;</span><br><span class="line">        retval = deleteNode(server, eventNodeId, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">if</span>(retval != UA_STATUSCODE_GOOD) &#123;</span><br><span class="line">            UA_LOG_WARNING(server-&gt;config.logging, UA_LOGCATEGORY_SERVER,</span><br><span class="line">                          <span class="string">&quot;Attempt to remove event using deleteNode failed. StatusCode %s&quot;</span>,</span><br><span class="line">                          UA_StatusCode_name(retval));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">cleanup:</span><br><span class="line">    UA_Array_delete(emitNodes, emitNodesSize, &amp;UA_TYPES[UA_TYPES_EXPANDEDNODEID]);</span><br><span class="line">    <span class="keyword">return</span> retval;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">UA_StatusCode</span><br><span class="line"><span class="title function_">UA_Server_triggerEvent</span><span class="params">(UA_Server *server, <span class="type">const</span> UA_NodeId eventNodeId,</span></span><br><span class="line"><span class="params">                      <span class="type">const</span> UA_NodeId origin, UA_ByteString *outEventId,</span></span><br><span class="line"><span class="params">                      <span class="type">const</span> UA_Boolean deleteEventNode)</span> &#123;</span><br><span class="line">    UA_LOCK(&amp;server-&gt;serviceMutex);</span><br><span class="line">    UA_StatusCode res =</span><br><span class="line">        triggerEvent(server, eventNodeId, origin, outEventId, deleteEventNode);</span><br><span class="line">    UA_UNLOCK(&amp;server-&gt;serviceMutex);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/11/01/OPCUA-open62541%E4%BA%8B%E4%BB%B6/" data-id="cm3om5odn0000h0vcaqx094vk" data-title="OPCUA-open62541事件" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-OPCUA-open62541多节点订阅" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/29/OPCUA-open62541%E5%A4%9A%E8%8A%82%E7%82%B9%E8%AE%A2%E9%98%85/" class="article-date">
  <time class="dt-published" datetime="2024-10-29T07:19:36.000Z" itemprop="datePublished">2024-10-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/">实习</a>►<a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/baosight/">baosight</a>►<a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/baosight/OPC-UA/">OPC_UA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/29/OPCUA-open62541%E5%A4%9A%E8%8A%82%E7%82%B9%E8%AE%A2%E9%98%85/">OPCUA open62541-节点订阅实现</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="open62541配置"><a href="#open62541配置" class="headerlink" title="open62541配置"></a>open62541配置</h2><ol>
<li>打开MULTITHREADING_DEFAULT，设置为100</li>
<li>注意区分是release还是debug包，相关的宏开关是CMAKE_BUILD_TYPE</li>
</ol>
<h2 id="server-c"><a href="#server-c" class="headerlink" title="server.c"></a>server.c</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.c</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* This work is licensed under a Creative Commons CCZero 1.0 Universal License.</span></span><br><span class="line"><span class="comment"> * See http://creativecommons.org/publicdomain/zero/1.0/ for more information. */</span></span><br><span class="line"></span><br><span class="line">#include &lt;signal.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;pthread.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">#include <span class="string">&quot;open62541.h&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="type">UA_Boolean</span> <span class="variable">running</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">uint32_t *nodeValues;</span><br><span class="line"><span class="type">int</span> <span class="variable">nodeCount</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">interval</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">stopHandler</span><span class="params">(<span class="type">int</span> sign)</span> &#123;</span><br><span class="line">    UA_LOG_INFO(UA_Log_Stdout, UA_LOGCATEGORY_SERVER, <span class="string">&quot;received ctrl-c&quot;</span>);</span><br><span class="line">    running = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">typedef struct container &#123;</span><br><span class="line">	UA_Server * ptr1;</span><br><span class="line">	UA_NodeId * ptr2;</span><br><span class="line">&#125; container_t;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> *thr_fn(<span class="keyword">void</span> *arg)</span><br><span class="line">&#123;</span><br><span class="line">    container_t *pContainer = (container_t*)arg;</span><br><span class="line">    UA_Server *server = pContainer-&gt;ptr1;</span><br><span class="line">    UA_NodeId *targetNodeIds = pContainer-&gt;ptr2;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        sleep(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i &lt; nodeCount; i++) &#123;</span><br><span class="line">            nodeValues[i]++;</span><br><span class="line">            <span class="type">uint32_t</span> <span class="variable">value</span> <span class="operator">=</span> nodeValues[i];</span><br><span class="line">            UA_Variant myVar;</span><br><span class="line">            UA_Variant_init(&amp;myVar);</span><br><span class="line">            UA_Variant_setScalar(&amp;myVar, &amp;value, &amp;UA_TYPES[UA_TYPES_INT32]);</span><br><span class="line">            UA_Server_writeValue(server, targetNodeIds[i], myVar);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> NULL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span><br><span class="line">&#123;    </span><br><span class="line">    signal(SIGINT, stopHandler);</span><br><span class="line">    signal(SIGTERM, stopHandler);</span><br><span class="line"></span><br><span class="line">    nodeCount = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    interval = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">    nodeValues = (uint32_t*)malloc(nodeCount * sizeof(uint32_t));</span><br><span class="line"></span><br><span class="line">    UA_Server *server = UA_Server_new();</span><br><span class="line">    UA_ServerConfig_setDefault(UA_Server_getConfig(server));</span><br><span class="line">    </span><br><span class="line">    UA_NodeId targetNodeIds[nodeCount];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nodeCount; i++) &#123;</span><br><span class="line">        <span class="comment">/* Define the attribute of the myInteger variable node */</span></span><br><span class="line">        <span class="type">UA_VariableAttributes</span> <span class="variable">attr</span> <span class="operator">=</span> UA_VariableAttributes_default;</span><br><span class="line">        <span class="type">UA_Int32</span> <span class="variable">myInteger</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">char</span> name[<span class="number">20</span>];</span><br><span class="line">        snprintf(name, sizeof(name), <span class="string">&quot;Node-%d&quot;</span>, i);</span><br><span class="line">        UA_Variant_setScalar(&amp;attr.value, &amp;myInteger, &amp;UA_TYPES[UA_TYPES_INT32]);</span><br><span class="line">        attr.description = UA_LOCALIZEDTEXT(<span class="string">&quot;en-US&quot;</span>, name);</span><br><span class="line">        attr.displayName = UA_LOCALIZEDTEXT(<span class="string">&quot;en-US&quot;</span>, name);</span><br><span class="line">        attr.dataType = UA_TYPES[UA_TYPES_INT32].typeId;</span><br><span class="line">        attr.accessLevel = UA_ACCESSLEVELMASK_READ | UA_ACCESSLEVELMASK_WRITE;</span><br><span class="line">        <span class="comment">/* Add the variable node to the information model */</span></span><br><span class="line">        <span class="type">UA_NodeId</span> <span class="variable">theAnswerNodeId</span> <span class="operator">=</span> UA_NODEID_STRING(<span class="number">1</span>, name);</span><br><span class="line">        <span class="type">UA_QualifiedName</span> <span class="variable">myIntegerName</span> <span class="operator">=</span> UA_QUALIFIEDNAME(<span class="number">1</span>, name);</span><br><span class="line">        <span class="type">UA_NodeId</span> <span class="variable">parentNodeId</span> <span class="operator">=</span> UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_OBJECTSFOLDER);</span><br><span class="line">        <span class="type">UA_NodeId</span> <span class="variable">parentReferenceNodeId</span> <span class="operator">=</span> UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_ORGANIZES);</span><br><span class="line">        UA_Server_addVariableNode(server, theAnswerNodeId, parentNodeId,</span><br><span class="line">            parentReferenceNodeId, myIntegerName,</span><br><span class="line">            UA_NODEID_NUMERIC(<span class="number">0</span>, UA_NS0ID_BASEDATAVARIABLETYPE), attr, NULL, &amp;targetNodeIds[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">container_t</span> <span class="variable">cont</span> <span class="operator">=</span> &#123;server, targetNodeIds&#125;;</span><br><span class="line">    pthread_t tid;</span><br><span class="line">    <span class="type">int</span> <span class="variable">err</span> <span class="operator">=</span> pthread_create(&amp;tid, NULL, thr_fn, &amp;cont);</span><br><span class="line">    <span class="keyword">if</span> (err != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        UA_LOG_ERROR(UA_Log_Stdout, UA_LOGCATEGORY_SERVER, <span class="string">&quot;Create thread Fail.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">UA_StatusCode</span> <span class="variable">retval</span> <span class="operator">=</span> UA_Server_run(server, &amp;running);</span><br><span class="line">    </span><br><span class="line">    UA_Server_delete(server);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> retval == UA_STATUSCODE_GOOD ? EXIT_SUCCESS : EXIT_FAILURE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>对应的client要注意一下创建UA_NodeId的namespace，可以先用browser订阅+监视看一下是多少</li>
</ul>
<h2 id="测试结果-T3"><a href="#测试结果-T3" class="headerlink" title="测试结果(T3)"></a>测试结果(T3)</h2><p><img src="/2024/10/29/OPCUA-open62541%E5%A4%9A%E8%8A%82%E7%82%B9%E8%AE%A2%E9%98%85/%E5%A4%9A%E8%8A%82%E7%82%B9%E8%AE%A2%E9%98%851.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/29/OPCUA-open62541%E5%A4%9A%E8%8A%82%E7%82%B9%E8%AE%A2%E9%98%85/" data-id="cm2wsgkvo00006cvcdq8b4pcr" data-title="OPCUA open62541-节点订阅实现" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-JVM" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/28/JVM/" class="article-date">
  <time class="dt-published" datetime="2024-10-28T15:39:22.000Z" itemprop="datePublished">2024-10-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/28/JVM/">JVM</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JAVA与C-之间有一堵由内存动态分配和GC所围成的高墙，墙外面的人想进去，墙里面的人想出来"><a href="#JAVA与C-之间有一堵由内存动态分配和GC所围成的高墙，墙外面的人想进去，墙里面的人想出来" class="headerlink" title="JAVA与C++之间有一堵由内存动态分配和GC所围成的高墙，墙外面的人想进去，墙里面的人想出来"></a>JAVA与C++之间有一堵由内存动态分配和GC所围成的高墙，墙外面的人想进去，墙里面的人想出来</h1><h2 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h2><ul>
<li>JAVA虚拟机管理的内存包括以下几个运行时数据区域：<ol>
<li>方法区</li>
<li>堆</li>
<li>虚拟机栈</li>
<li>程序计数器：当前线程所执行的字节码的行号指示器，是程序控制流的指示器。</li>
<li>本地方法栈</li>
</ol>
</li>
<li>程序计数器：由于JAVA虚拟机的多线程是通过线程轮流切换，分配处理器时间实现的，在任何一个时刻只会有一条线程中的指令被执行，因此每个线程要有一个独立的程序计数器（在线程私有的内存区域中存储）。如果执行的是Native方法（在Java中，native方法是一种特殊的方法，它允许Java调用非Java代码，通常是C或C++语言编写的本地方法。这些方法在Java类中声明，但不在Java代码中实现，而是在本地库中实现，并通过Java Native Interface（JNI）与Java代码交互。），那么计数器值应该为空，此内存区域没有规定OutOfMeomoryError错误、</li>
<li>Java虚拟机栈：同样是线程私有的，描述的是Java方法执行的线程内存模型：每个方法被执行时，Java虚拟机栈会同步创建一个栈帧用于存储局部变量表（基础数据类型，对象引用），操作数栈，动态连接，方法出口等信息。数据类型在局部变量表中的存储以局部变量槽（Slot）表示。</li>
<li>本地方法栈：和Java虚拟机栈类似，但是是为Native方法服务的，前者是为Java方法服务的。</li>
<li>Java堆：<strong>所有线程共享</strong>。由垃圾收集器（几乎都基于分代设计，需要新老代收集器搭配工作）管理。从内存分配的角度上，可以分配出线程私有的分配缓冲区。Java堆可以在物理上不连续的内存空间中，但是逻辑上应该被看做连续的。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/28/JVM/" data-id="cm2t8girt0000gcvcfgoihoiy" data-title="JVM" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-JAVA" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/26/JAVA/" class="article-date">
  <time class="dt-published" datetime="2024-10-26T10:16:50.000Z" itemprop="datePublished">2024-10-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/26/JAVA/">JAVA</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><p>当对象被序列化时，被该对象持有的实例变量也会被序列化，所有被引用的对象也会被实例化，这些操作都是自动进行的</p>
<ul>
<li>要让类能被序列化，要实现Serializable接口</li>
<li>如果要让实例变量不被序列化，<strong>用transient关键字修饰</strong></li>
<li></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/26/JAVA/" data-id="cm2t8fzex0000dgvcha00cv3s" data-title="JAVA" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux常用命令" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/24/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="article-date">
  <time class="dt-published" datetime="2024-10-24T09:22:47.000Z" itemprop="datePublished">2024-10-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/24/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Linux常用命令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><ul>
<li>-A ：所有的进程均显示出来，与 -e 具有同样的效用；</li>
<li>-a ： 显示现行终端机下的所有进程，包括其他用户的进程；</li>
<li>-u ：以用户为主的进程状态 ；</li>
<li>-x ：通常与 a 这个参数一起使用，可列出较完整信息。</li>
<li>-l ：较长、较详细的将该PID 的的信息列出；</li>
<li>-j ：工作的格式 (jobs format)</li>
<li>-f ：做一个更为完整的输出</li>
<li><img src="/2024/10/24/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/ps.png"></li>
<li>通过<code>ps aux | grep name</code>查询特定名字进程的相关信息</li>
</ul>
<h2 id="top"><a href="#top" class="headerlink" title="top"></a>top</h2><ul>
<li>top的使用方式 top [-d number] | top [-bnp]<ul>
<li>-d number	number代表秒数，表示top命令显示的页面更新一次的间隔 (default&#x3D;5s)</li>
<li>-b	以批次的方式执行top</li>
<li>-n	与-b配合使用，表示需要进行几次top命令的输出结果</li>
<li>-p	指定特定的pid进程号进行观察</li>
</ul>
</li>
<li><img src="/2024/10/24/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/top.png"></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/24/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" data-id="cm2t8fzf80002dgvc53cqcmi5" data-title="Linux常用命令" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开发技巧" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/23/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" class="article-date">
  <time class="dt-published" datetime="2024-10-23T02:58:46.000Z" itemprop="datePublished">2024-10-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%97%A5%E5%B8%B8%E5%BC%80%E5%8F%91/">日常开发</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/23/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/">开发技巧</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="快速格式化代码"><a href="#快速格式化代码" class="headerlink" title="快速格式化代码"></a>快速格式化代码</h2><ul>
<li>Windows &#x2F; Linux: Shift + Alt + F</li>
<li>macOS: Shift + Option + F</li>
</ul>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><ul>
<li>在函数上方输入 &#x2F;**，然后按下 Enter，VS Code 会自动生成基本的注释结构。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/23/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" data-id="cm2t8fzfd0006dgvchm5h1q02" data-title="开发技巧" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-OPCUA-open62541加密原理" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/23/OPCUA-open62541%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86/" class="article-date">
  <time class="dt-published" datetime="2024-10-23T02:48:45.000Z" itemprop="datePublished">2024-10-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/">实习</a>►<a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/baosight/">baosight</a>►<a class="article-category-link" href="/categories/%E5%AE%9E%E4%B9%A0/baosight/OPC-UA/">OPC_UA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/23/OPCUA-open62541%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86/">OPUCA open62541-加密原理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="加密流程"><a href="#加密流程" class="headerlink" title="加密流程"></a>加密流程</h2><p><img src="/2024/10/23/OPCUA-open62541%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86/opcua%E5%8A%A0%E5%AF%86.png" alt="alt text"></p>
<h2 id="加密通信相关代码"><a href="#加密通信相关代码" class="headerlink" title="加密通信相关代码"></a>加密通信相关代码</h2><h3 id="securityPolicy"><a href="#securityPolicy" class="headerlink" title="securityPolicy"></a>securityPolicy</h3><p>+ </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">UA_SecurityPolicy</span> &#123;</span></span><br><span class="line">    <span class="comment">/* Additional data */</span></span><br><span class="line">    <span class="type">void</span> *policyContext;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* The policy uri that identifies the implemented algorithms */</span></span><br><span class="line">    UA_String policyUri;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Value indicating the crypto strength of the policy, with zero for deprecated or none */</span></span><br><span class="line">    UA_Byte securityLevel;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* The local certificate is specific for each SecurityPolicy since it</span></span><br><span class="line"><span class="comment">     * depends on the used key length. */</span></span><br><span class="line">    UA_ByteString localCertificate;</span><br><span class="line"></span><br><span class="line">    UA_NodeId certificateGroupId;</span><br><span class="line">    UA_NodeId certificateTypeId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Function pointers grouped into modules */</span></span><br><span class="line">    UA_SecurityPolicyAsymmetricModule asymmetricModule; <span class="comment">// 包括证书指纹生成算法，加密算法，签名算法等等</span></span><br><span class="line">    UA_SecurityPolicySymmetricModule symmetricModule;</span><br><span class="line">    UA_SecurityPolicySignatureAlgorithm certificateSigningAlgorithm;</span><br><span class="line">    UA_SecurityPolicyChannelModule channelModule;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> UA_Logger *logger;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Updates the ApplicationInstanceCertificate and the corresponding private</span></span><br><span class="line"><span class="comment">     * key at runtime. */</span></span><br><span class="line">    UA_StatusCode (*updateCertificateAndPrivateKey)(UA_SecurityPolicy *policy,</span><br><span class="line">                                                    <span class="type">const</span> UA_ByteString newCertificate,</span><br><span class="line">                                                    <span class="type">const</span> UA_ByteString newPrivateKey);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Creates a PKCS #10 DER encoded certificate request signed with the server&#x27;s</span></span><br><span class="line"><span class="comment">     * private key.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param securityPolicy The securityPolicy to work on.</span></span><br><span class="line"><span class="comment">     * @param subjectName The subject name to use in the Certificate Request.</span></span><br><span class="line"><span class="comment">     *                    If not specified the SubjectName from the current Certificate is used.</span></span><br><span class="line"><span class="comment">     * @param nonce Additional entropy that the caller can provide.</span></span><br><span class="line"><span class="comment">     *              It shall be at least 32 bytes long.</span></span><br><span class="line"><span class="comment">     * @param params A KeyVaue list that can be used for additional parameters later.</span></span><br><span class="line"><span class="comment">     * @param csr Returns the created CSR. If the passed byte string is not empty, nothing is created.</span></span><br><span class="line"><span class="comment">     * @param newPrivateKey Returns the private key if a new one needs to be generated.</span></span><br><span class="line"><span class="comment">     *                      Alternatively, an existing key can be provided,</span></span><br><span class="line"><span class="comment">     *                      which will be used as the CSR key in the security policy.</span></span><br><span class="line"><span class="comment">     *                      This is necessary if the CSR was created under a different security policy</span></span><br><span class="line"><span class="comment">     *                      and the current one only requires an update.</span></span><br><span class="line"><span class="comment">     * @return If the CSR creation was successful, UA_STATUSCODE_GOOD is returned. */</span></span><br><span class="line">    UA_StatusCode (*createSigningRequest)(UA_SecurityPolicy *securityPolicy,</span><br><span class="line">                                          <span class="type">const</span> UA_String *subjectName,</span><br><span class="line">                                          <span class="type">const</span> UA_ByteString *nonce,</span><br><span class="line">                                          <span class="type">const</span> UA_KeyValueMap *params,</span><br><span class="line">                                          UA_ByteString *csr,</span><br><span class="line">                                          UA_ByteString *newPrivateKey);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Deletes the dynamic content of the policy */</span></span><br><span class="line">    <span class="type">void</span> (*clear)(UA_SecurityPolicy *policy);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<h3 id="安全令牌轮换"><a href="#安全令牌轮换" class="headerlink" title="安全令牌轮换"></a>安全令牌轮换</h3><p>续订安全令牌的目的是在安全通信通道（如加密会话）中定期更换令牌，以增强安全性并防止重放攻击。</p>
<p>+ </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Rules for revolving the token with a renew OPN request: The client is</span></span><br><span class="line"><span class="comment"> * allowed to accept messages with the old token until the OPN response has</span></span><br><span class="line"><span class="comment"> * arrived. The server accepts the old token until one message secured with</span></span><br><span class="line"><span class="comment"> * the new token has arrived.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * We recognize whether nextSecurityToken contains a valid next token if the</span></span><br><span class="line"><span class="comment"> * ChannelId is not 0. */</span></span><br><span class="line">UA_ChannelSecurityToken securityToken;    <span class="comment">/* Also contains the channelId */</span></span><br><span class="line">UA_ChannelSecurityToken altSecurityToken; <span class="comment">/* Alternative token for the rollover.</span></span><br><span class="line"><span class="comment">                                           * See the renewState. */</span></span><br></pre></td></tr></table></figure>
<ul>
<li>令牌轮换的规则<ol>
<li>客户端规则: 当客户端发送带有续订的 OpenSecureChannelRequest (OPN) 请求时，客户端可以继续使用旧的安全令牌，直到服务器返回的 OPN 响应到达为止。这意味着客户端在这个过程中还可以接受用旧令牌加密的消息。</li>
<li>服务器规则: 服务器则允许使用旧的安全令牌，直到它收到客户端用新的安全令牌加密的消息为止。即，服务器知道客户端已经开始使用新令牌。</li>
</ol>
</li>
<li>如何识别下一个安全令牌是否有效<br>下一个安全令牌的有效性可以通过检查 nextSecurityToken 中的 ChannelId 字段来确认。如果 ChannelId 不为 0，表示下一个安全令牌有效。ChannelId 是标识通信信道的唯一标识符，通常它在有效的通信会话中是非零的。</li>
<li>renewState是一个状态机，用于跟踪续订请求的状态，以确保安全令牌的顺利轮换。</li>
</ul>
<h3 id="padding（-c文件内搜索add-padding）"><a href="#padding（-c文件内搜索add-padding）" class="headerlink" title="padding（.c文件内搜索add padding）"></a>padding（.c文件内搜索add padding）</h3><p>+<br>    <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Assumes that pos can be advanced to the end of the current block */</span></span><br><span class="line"><span class="type">void</span></span><br><span class="line"><span class="title function_">padChunk</span><span class="params">(UA_SecureChannel *channel, <span class="type">const</span> UA_SecurityPolicyCryptoModule *cm,</span></span><br><span class="line"><span class="params">        <span class="type">const</span> UA_Byte *start, UA_Byte **pos)</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">size_t</span> bytesToWrite = (<span class="type">uintptr_t</span>)*pos - (<span class="type">uintptr_t</span>)start;</span><br><span class="line">    <span class="type">size_t</span> signatureSize = cm-&gt;signatureAlgorithm.</span><br><span class="line">        getLocalSignatureSize(channel-&gt;channelContext);</span><br><span class="line">    <span class="type">size_t</span> plainTextBlockSize = cm-&gt;encryptionAlgorithm.</span><br><span class="line">        getRemotePlainTextBlockSize(channel-&gt;channelContext);</span><br><span class="line">    UA_Boolean extraPadding = (cm-&gt;encryptionAlgorithm.</span><br><span class="line">        getRemoteKeyLength(channel-&gt;channelContext) &gt; <span class="number">2048</span>);</span><br><span class="line">    <span class="type">size_t</span> paddingBytes = (UA_LIKELY(!extraPadding)) ? <span class="number">1u</span> : <span class="number">2u</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> lastBlock = ((bytesToWrite + signatureSize + paddingBytes) % plainTextBlockSize);</span><br><span class="line">    <span class="type">size_t</span> paddingLength = (lastBlock != <span class="number">0</span>) ? plainTextBlockSize - lastBlock : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    UA_LOG_TRACE_CHANNEL(channel-&gt;securityPolicy-&gt;logger, channel,</span><br><span class="line">                        <span class="string">&quot;Add %lu bytes of padding plus %lu padding size bytes&quot;</span>,</span><br><span class="line">                        (<span class="type">long</span> <span class="type">unsigned</span> <span class="type">int</span>)paddingLength,</span><br><span class="line">                        (<span class="type">long</span> <span class="type">unsigned</span> <span class="type">int</span>)paddingBytes);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Write the padding. This is &lt;= because the paddingSize byte also has to be</span></span><br><span class="line"><span class="comment">    * written */</span></span><br><span class="line">    UA_Byte paddingByte = (UA_Byte)paddingLength;</span><br><span class="line">    <span class="keyword">for</span>(UA_UInt16 i = <span class="number">0</span>; i &lt;= paddingLength; ++i) &#123;</span><br><span class="line">        **pos = paddingByte;</span><br><span class="line">        ++*pos;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Write the extra padding byte if required */</span></span><br><span class="line">    <span class="keyword">if</span>(extraPadding) &#123;</span><br><span class="line">        **pos = (UA_Byte)(paddingLength &gt;&gt; <span class="number">8u</span>);</span><br><span class="line">        ++*pos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>    + UA_SecureChannel是安全通道的上下文类，包括channel状态，连接配置，安全模式等channel的信息，以及绑定到这个channel上的session，接收到的message chunk等信息</p>
<h3 id="sign-encrypt"><a href="#sign-encrypt" class="headerlink" title="sign &amp; encrypt"></a>sign &amp; encrypt</h3><h4 id="asym"><a href="#asym" class="headerlink" title="asym"></a>asym</h4><p>+ </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">UA_StatusCode</span><br><span class="line"><span class="title function_">signAndEncryptAsym</span><span class="params">(UA_SecureChannel *channel, <span class="type">size_t</span> preSignLength,</span></span><br><span class="line"><span class="params">                   UA_ByteString *buf, <span class="type">size_t</span> securityHeaderLength,</span></span><br><span class="line"><span class="params">                   <span class="type">size_t</span> totalLength)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(channel-&gt;securityMode != UA_MESSAGESECURITYMODE_SIGN &amp;&amp;</span><br><span class="line">       channel-&gt;securityMode != UA_MESSAGESECURITYMODE_SIGNANDENCRYPT)</span><br><span class="line">        <span class="keyword">return</span> UA_STATUSCODE_GOOD;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Sign message */</span></span><br><span class="line">    <span class="type">const</span> UA_SecurityPolicy *sp = channel-&gt;securityPolicy;</span><br><span class="line">    <span class="type">const</span> UA_ByteString dataToSign = &#123;preSignLength, buf-&gt;data&#125;;</span><br><span class="line">    <span class="type">size_t</span> sigsize = sp-&gt;asymmetricModule.cryptoModule.signatureAlgorithm.</span><br><span class="line">        getLocalSignatureSize(channel-&gt;channelContext);</span><br><span class="line">    UA_ByteString signature = &#123;sigsize, buf-&gt;data + preSignLength&#125;;</span><br><span class="line">    UA_StatusCode retval = sp-&gt;asymmetricModule.cryptoModule.signatureAlgorithm.</span><br><span class="line">        sign(channel-&gt;channelContext, &amp;dataToSign, &amp;signature);</span><br><span class="line">    UA_CHECK_STATUS(retval, <span class="keyword">return</span> retval);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Specification part 6, 6.7.4: The OpenSecureChannel Messages are</span></span><br><span class="line"><span class="comment">     * signed and encrypted if the SecurityMode is not None (even if the</span></span><br><span class="line"><span class="comment">     * SecurityMode is SignOnly). */</span></span><br><span class="line">    <span class="type">size_t</span> unencrypted_length =</span><br><span class="line">        UA_SECURECHANNEL_CHANNELHEADER_LENGTH + securityHeaderLength;</span><br><span class="line">    UA_ByteString dataToEncrypt = &#123;totalLength - unencrypted_length,</span><br><span class="line">                                   &amp;buf-&gt;data[unencrypted_length]&#125;;</span><br><span class="line">    <span class="keyword">return</span> sp-&gt;asymmetricModule.cryptoModule.encryptionAlgorithm.</span><br><span class="line">        encrypt(channel-&gt;channelContext, &amp;dataToEncrypt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="传输"><a href="#传输" class="headerlink" title="传输"></a>传输</h3><h4 id="adjustCheckMessageLimitsSym-超出非对称加密的限制长度的处理-–-分包发送"><a href="#adjustCheckMessageLimitsSym-超出非对称加密的限制长度的处理-–-分包发送" class="headerlink" title="adjustCheckMessageLimitsSym()超出非对称加密的限制长度的处理 – 分包发送"></a>adjustCheckMessageLimitsSym()超出非对称加密的限制长度的处理 – 分包发送</h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/23/OPCUA-open62541%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86/" data-id="cm2la0nwc000534vcbazx92x8" data-title="OPUCA open62541-加密原理" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-MVC&amp;DDD" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/22/MVC&DDD/" class="article-date">
  <time class="dt-published" datetime="2024-10-22T07:48:38.000Z" itemprop="datePublished">2024-10-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a>►<a class="article-category-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/">系统架构</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/22/MVC&DDD/">MVC &amp; DDD</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="传统的MVC结构："><a href="#传统的MVC结构：" class="headerlink" title="传统的MVC结构："></a>传统的MVC结构：</h2><ul>
<li><p>分层</p>
<ol>
<li>M - model 对象层，封装到 domain 里。</li>
<li>V - view 展示层，但因为目前都是前后端分离的项目，几乎不会在后端项目里写 JSP 文件了。</li>
<li>C - Controller 控制层，对外提供接口实现类。HTTP接口</li>
<li>DAO 算是单独拿出来用户处理数据库操作的层。</li>
<li>Service：功能方法，服务层逻辑的实现</li>
</ol>
</li>
<li><p>调用流程：<br><img src="/2024/10/22/MVC&DDD/MVC%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B.png"></p>
</li>
</ul>
<h2 id="DDD"><a href="#DDD" class="headerlink" title="DDD"></a>DDD</h2><ul>
<li>什么是DDD：DDD 是一种软件设计方法。也就是说 DDD 是指导我们做软件工程设计的一种手段，它提供了用切割工程模型的各类技巧<ul>
<li>充血模型：指将对象的属性信息与行为逻辑聚合到一个类中，常用的手段如在对象内提供属于当前对象的信息校验、拼装缓存Key、不含服务接口调用的逻辑处理等。</li>
<li><img src="/2024/10/22/MVC&DDD/%E5%85%85%E8%A1%80&%E8%B4%AB%E8%A1%80%E6%A8%A1%E5%9E%8B.png"></li>
<li>DDD最大的区别在于把原有的众多 Service + 数据模型的方式，拆分为独立的有边界的领域模块。每个领域内创建自身所属的；领域对象（实体、聚合、值对象）、仓储服务(DAO 操作)、工厂、端口适配器Port（调用外部接口的手段）等。   </li>
<li>在原本的 Service + 贫血的数据模型开发指导下，Service 串联调用每一个功能模块。这些基础设施（对象、方法、接口）是被相互掉调用的。这也是因为贫血模型并没有面向对象的设计，所有的需求开发只有详细设计。  </li>
<li>换到充血模型下，现在我们以一个领域功能为聚合，拆分一个领域内所需的 Service 为领域服务，VO、Req、Res 重新设计为领域对象，DAO、Redis 等持久化操作为仓储等。举例；一套账户服务中的，授信认证、开户、提额降额等，每一个都是一个独立的领域，在每个独立的领域内，创建自身领域所需的各项信息。</li>
<li>领域模型还有一个特点，它自身只关注业务功能实现，不与外部任何接口和服务直连。如；不会直接调用 DAO 操作库，也不会调用缓存操作 Redis，更不会直接引入 RPC 连接其他微服务。而是通过仓库和端口适配器，定义调用外部数据的含有出入参对象的接口标准，让基础设施层做具体的调用实现。通过这样的方式让领域只关心业务实现，同时做好防腐。</li>
<li>仓储与适配器：在 DDD 的设计方法中，领域层做到了只关心领域服务实现。最能体现这样设计的就是仓库和适配器的设计。通常在 Service + 数据模型的设计中，会在 Service 中引入 Redis、RPC、配置中心等各类其他外部服务。但在 DDD 中，通过仓储和适配器以及基础设施层的定义，解耦了这部分内容。</li>
</ul>
</li>
<li>DDD VS MVC<ul>
<li>如果你接触过较大型且已经长期维护项目的 MVC 架构，你就会发现这里的 DAO、PO、VO 对象，在 Service 层相互调用。那么长期开发后，就导致了各个 PO 里的属性字段数量都被撑的特别大。这样的开发方式，将”状态”、“行为“分离到不同的对象中，代码的意图渐渐模糊，膨胀、臃肿和不稳定的架构，让迭代成本增加。</li>
<li>而 DDD 架构首先以解决此类问题为主，将各个属于自己领域范围内的行为和逻辑封装到自己的领域包下处理。这也是 DDD 架构设计的精髓之一。它希望在分治层面合理切割问题空间为更小规模的若干子问题，而问题越小就容易被理解和处理，做到高内聚低耦合。这也是康威定律所提到的，解决复杂场景的设计主要分为：分治、抽象和知识。</li>
<li><img src="/2024/10/22/MVC&DDD/MVC%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B.png"></li>
<li><img src="/2024/10/22/MVC&DDD/MVC%E8%BF%81%E7%A7%BBDDD.png"></li>
</ul>
</li>
<li>DDD模块示例：<ul>
<li><img src="/2024/10/22/MVC&DDD/DDD%E6%A8%A1%E5%9D%97.png"></li>
<li><img src="/2024/10/22/MVC&DDD/DDD%E6%A8%A1%E5%9D%972.png"></li>
<li>DDD分层解析：<ol>
<li>领域层：一个领域层内可以有多个领域包，例如账户领域包，结算领域包。每一个 domain 下的领域包内，都包括：model 模型、仓储、接口、事件和服务的处理。</li>
</ol>
<ul>
<li>model 模型对象<ol>
<li>aggreate：聚合对象，实体对象、值对象的协同组织，就是聚合对象。</li>
<li>entity：实体对象，大多数情况下，实体对象(Entity)与数据库持久化对象(PO)是1v1的关系，但也有为了封装一些属性信息，会出现1vn的关系。</li>
<li>valobj：值对象，通过对象属性值来识别的对象 By 《实现领域驱动设计》</li>
</ol>
</li>
<li>repository 仓储服务：从数据库等数据源中获取数据，传递的对象可以是聚合对象、实体对象，返回的结果可以是：实体对象、值对象。因为仓储服务是由基础层(infrastructure) 引用领域层(domain)，是一种依赖倒置的结构，但它可以天然的隔离PO数据库持久化对象被引用。</li>
<li>adapter 接口服务：是依赖于外包的其他 HTTP&#x2F;RPC 接口的封装调用，通过在 domain 领域层定义适配器接口，再由依赖于 domain 的基础层设施层或者一个单独的专门处理接口的额外分层，来实现 domain 定义的适配器接口，完成对依赖的 HTTP&#x2F;RPC 进行封装处理。</li>
<li>event 事件消息：在服务实现中，经常会有业务完成后，对外发送消息的情况。这个时候，可以在领域模型中定义事件消息的接口，再由基础设施层完成消息的推送。</li>
<li>service 服务设计：这里要注意，不要以为定义了聚合对象，就把超越1个对象以外的逻辑，都封装到聚合中，这会让你的代码后期越来越难维护。聚合更应该注重的是和本对象相关的单一简单封装场景，而把一些重核心业务放到 service 里实现。此外，如果你的设计模式应用不佳，那么无论是领域驱动设计、测试驱动设计还是换了三层和四层架构，你的工程质量依然会非常差。</li>
</ul>
<ol start="2">
<li>基础设施层：提供数据库持久化、提供Redis和配置中心数据支撑、提供事件消息推送、提供外部服务接口封装。总之这一层的核心目的就是更好的辅助 domain 领域层完成领域功能的开发。而调用方式则为依赖倒置，也就是领域服务层定义接口，基础设施层做功能实现。这样可以有效的避免基础设施层中的对象被对外暴露，如数据库持久化对象，在这样的分层结构中，天然的被保护在基础设施层中，外部是没法引入的，否则就循环依赖了。</li>
</ol>
</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/22/MVC&DDD/" data-id="cm31tgkof0000qovc06fxg20c" data-title="MVC &amp; DDD" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-IO多路复用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/21/IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2024-10-21T08:47:21.000Z" itemprop="datePublished">2024-10-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a>►<a class="article-category-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%BD%91%E7%BB%9C%E7%B3%BB%E7%BB%9F/">网络系统</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/10/21/IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/">IO多路复用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="简单socket模型"><a href="#简单socket模型" class="headerlink" title="简单socket模型"></a>简单socket模型</h2><ol>
<li>服务端调用socket()函数，指定网络协议和传输层协议，调用bind()绑定IP和端口</li>
<li>调用listen()监听，客户端connect()建立连接，服务端accept()取出与客户端的连接</li>
<li>连接建立后read()，write()读写数据</li>
<li>在这个过程里面，有两个socket，服务端监听端口的socket和客户端与服务端用于连接传输的socket</li>
</ol>
<h2 id="IO多路复用"><a href="#IO多路复用" class="headerlink" title="IO多路复用"></a>IO多路复用</h2><ul>
<li>复用IO的基本思路就是通过slect或poll、epoll 来监控多fd ，来达到不必为每个fd创建一个对应的监控线程，从而减少线程资源创建的目的。当发现某个描述符就绪之后，能够通知程序进行相应的读写操作。</li>
</ul>
<h3 id="select"><a href="#select" class="headerlink" title="select"></a>select</h3><ul>
<li><code>int select(int maxfdp1,fd_set *readset,fd_set *writeset,fd_set *exceptset,const struct timeval *timeout);</code></li>
<li>运行机制：参数有一个 fd_set 集合，其实这是一个 long 类型的数组，数组元素能够与已经打开的文件句柄（例如 Socket 句柄，又或者其它文件）建立联系。当我们调用 select 函数时，内核会根据 IO 状态对 fd_set 的内容进行修改，从而通知执行 select 函数的进程哪一个文件或者 Socket 是可读的。select 函数与同步阻塞模型并无过多区别，甚至还多出了一部分操作（监视 socket &#x2F;调用 select 函数），导致更低的效率。</li>
<li>优势：用户可以在一个线程内同时处理多个 socket 的 IO 请求。用户可以注册多个 socket，然后调用 select 函数读取被激活的 socket，从而实现在同一个线程内同时处理多个 IO 请求，在这点上select 函数与同步阻塞模型不同，因为在同步阻塞模型中需要通过多线程才能达到这个目的。话说回来，为啥我们不直接使用多进程&#x2F;多线程技术，而是要使用 IO 多路复用技术呢?这是因为，使用 IO 多路复用技术，系统不必创建和维护进程&#x2F;线程，从而节约了系统的开销。</li>
<li>缺点：<ol>
<li>调用 select 函数时，需要把 fd_set 集合从用户态拷贝到内核态，当 fd_set 集合很大时，这个开销将会非常巨大，且需要在内核遍历传递进来的所有 fd_set，当 fd_set 集合很大时，这个开销将会非常巨大。</li>
<li>fd_set集合大小有限制</li>
</ol>
</li>
</ul>
<h3 id="poll"><a href="#poll" class="headerlink" title="poll"></a>poll</h3><ul>
<li><code>int poll(struct pollfd *fds, nfds_t nfds, int timeout);</code></li>
<li>运行机制：select 函数中，内核对 fd_set 集合的大小做出了限制，大小不可变为1024；而 poll 函数中，并没有最大文件描述符数量的限制（基于链表存储）。其余和select没有区别</li>
</ul>
<h3 id="epoll"><a href="#epoll" class="headerlink" title="epoll"></a>epoll</h3><ul>
<li>源码<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">epoll_create</span><span class="params">(<span class="type">int</span> size)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">epoll_ctl</span><span class="params">(<span class="type">int</span> epfd, <span class="type">int</span> op, <span class="type">int</span> fd, <span class="keyword">struct</span> epoll_event *event)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">epoll_wait</span><span class="params">(<span class="type">int</span> epfd, <span class="keyword">struct</span> epoll_event * events, <span class="type">int</span> maxevents, <span class="type">int</span> timeout)</span></span>;</span><br></pre></td></tr></table></figure>
<ol>
<li>epoll_create：创建一个 epoll 句柄，其中 size 表示内核要监听的描述符数量</li>
<li>epoll_ctl：注册要监听的事件类型。在每次注册新的事件到 epoll 句柄中时，会把所有的描述符拷贝进内核，而不是在 epoll_wait 的时候重复拷贝。epoll 保证了每个描述符在整个过程中只会拷贝一次。epoll_ctl函数添加进来的事件都会被放在红黑树的某个节点内</li>
<li>epoll_wait：等待事件的就绪，成功时返回就绪的事件数目<br><img src="/2024/10/21/IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/epoll.png"></li>
</ol>
</li>
<li>epoll 是 poll 的增强版，在获取事件时，epoll 无需遍历整个被监听的描述符集，而是只需遍历被内核 IO 事件异步唤醒而加入 Ready 队列的描述符集合即可。因此，epoll 能显著提高程序在大量并发连接中只有少量活跃的情况下的系统 CPU 利用率。epoll 会在 epoll_ctl 时为每个描述符指定一个回调函数，当设备就绪，唤醒等待队列上的等待者时，就会调用这个回调函数，而这个回调函数会把就绪的描述符加入一个就绪链表。epoll_wait 实际上就是去就绪链表中查看有没有就绪的描述符。</li>
<li>优势：<ol>
<li>没有最大连接数限制</li>
<li>不用轮询所有连接，只需要处理活跃连接</li>
<li>epoll是通过内核与用户空间mmap同一块内存实现的，mmap将用户空间的一块地址和内核空间的一块地址同时映射到相同的一块物理内存地址。减少用户态和内核态之间的数据交换的复制开销。</li>
</ol>
</li>
<li>模式：<ul>
<li>水平触发（LT）：默认工作模式，当 epoll_wait 检测到某描述符事件就绪并通知应用程序时，应用程序可以不立即处理该事件；等到下次调用 epoll_wait 时，会再次通知此事件</li>
<li>边缘触发（ET）：当 epoll_wait 检测到某描述符事件就绪并通知应用程序时，应用程序必须立即处理该事件。如果不处理，下次调用 epoll_wait 时，不会再次通知此事件</li>
<li>ET 模式减少了 epoll 事件的触发次数，其效率比 LT 模式下高。为什么呢？如果我们使用 LT 模式的话，系统中一旦有大量不需要读写的就绪文件描述符，每次调用 epoll_wait 都会返回，大大降低处理程序检索自己关心的就绪文件描述符的效率。如果使用的是 ET 模式，当被监控的文件描述符上有可读写事件发生时，epoll_wait 会通知处理程序去读写，如果这次没有把数据全部读写完，下次调用 epoll_wait 不会通知你，即它只会通知你一次，直到该文件描述符上出现第二次可读写事件才会通知你。在这种模式下，系统不会充斥大量你不关心的就绪文件描述符，故其效率较高。</li>
</ul>
</li>
<li>总结：select，poll 需要自己不断轮询所有描述符集合，直到设备就绪，期间可能要睡眠和唤醒多次交替。epoll 其实也需要调用 epoll_wait 不断轮询就绪链表，期间也可能多次睡眠和唤醒交替，但是它是设备就绪时，调用回调函数，把就绪描述符放入就绪链表中，并唤醒在 epoll_wait 中进入睡眠的进程。虽然都要睡眠和交替，但是 select 和 poll 在醒着的时候要遍历整个描述符集合，而epoll在醒着的时候只要判断一下就绪链表是否为空即可，这就是回调机制带来的性能提升，节省了大量的 CPU 时间。</li>
<li>对比：<ol>
<li>IO 效率：select 只知道有 IO 事件发生，却不知道是哪几个流，只能采取轮询所有流的方式，故其具有 O(n) 的无差别轮询复杂度，处理的流越多，无差别轮询时间就越长；poll 与 select 并无区别，它的时间复杂度也是 O(n)；epoll 会将哪个流发生了怎样的 IO 事件通知我们（当描述符就绪时，系统注册的回调函数会被调用，将就绪描述符放到 readyList 里面），它是事件驱动的，其时间复杂度为 O(1)</li>
<li>操作方式：select 和 poll 都是采取遍历的方式，而 epoll 则是采取了回调的方式</li>
<li>底层实现：select 的底层实现为数组，poll 的底层实现为链表，而 epoll 的底层实现为红黑树</li>
<li>最大连接数：select 的最大连接数为 1024 或 2048，而 poll 和 epoll 是无上限的</li>
<li>对描述符的拷贝：select 和 poll 每次被调用时都会把描述符集合从用户态拷贝到内核态，而 epoll 在调用 epoll_ctl 时会拷贝进内核并保存，之后每次 epoll_wait 时不会拷贝</li>
<li>性能：epoll 在绝大多数情况下性能远超 select 和 poll，但在连接数少并且连接都十分活跃的情况下，select 和 poll 的性能可能比 epoll 好，因为 epoll 的通知机制需要很多函数回调</li>
</ol>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/21/IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/" data-id="cm2irwt2n00002svcdb9obfdt" data-title="IO多路复用" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/LCR119/">LCR119</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode101/">LeetCode101</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode101/%E5%9B%9E%E6%BA%AF/">回溯</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode101/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2/">深度优先搜索</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Makefile/">Makefile</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mybatis/">Mybatis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/REDIS/">REDIS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo/">Dubbo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/MIT-6824/">MIT-6824</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/RabbitMQ/">RabbitMQ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/">系统架构</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/CSS/">CSS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/HTML/">HTML</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/TypeScript/">TypeScript</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%9E%E4%B9%A0/">实习</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%9E%E4%B9%A0/baosight/">baosight</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%9E%E4%B9%A0/baosight/OPC-UA/">OPC_UA</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E7%BD%91%E7%BB%9C%E7%B3%BB%E7%BB%9F/">网络系统</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/SQL/">SQL</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A5%E5%B8%B8%E5%BC%80%E5%8F%91/">日常开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A7%91%E7%A0%94/">科研</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A7%91%E7%A0%94/ImageMatchingfromHandcraftedtoDeepFeatures-ASurvey/">ImageMatchingfromHandcraftedtoDeepFeatures:ASurvey</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/%E5%88%86%E6%B2%BB/">分治</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/%E5%8D%95%E8%B0%83%E6%A0%88/">单调栈</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95/">常用算法</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C/">网络</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%BE%E7%A8%8B/">课程</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%BE%E7%A8%8B/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/">软件设计</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%A1%B9%E7%9B%AE/%E6%8F%8F%E8%BF%B0%E4%B8%8E%E9%9D%A2%E8%AF%95/">描述与面试</a></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/11/17/JAVA%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a>
          </li>
        
          <li>
            <a href="/2024/11/17/RabbitMQ/">RabbitMQ</a>
          </li>
        
          <li>
            <a href="/2024/11/16/Dubbo/">Dubbo</a>
          </li>
        
          <li>
            <a href="/2024/11/15/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/">数据库基础</a>
          </li>
        
          <li>
            <a href="/2024/11/13/Spring-%E4%BA%8B%E5%8A%A1/">Spring-事务</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>